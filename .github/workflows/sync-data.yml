name: Sniper Pharma Inteligente
on:
  workflow_dispatch:
  schedule:
    - cron: '0 3 * * *'      # Varredura diÃ¡ria 3h
    - cron: '0 5 1,16 * *'    # RevisÃ£o dias 1/16 5h

jobs:
  run-bot:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      actions: write
    steps:
    - uses: actions/checkout@v3
      with: persist-credentials: true
      
    - name: Setup Python
      uses: actions/setup-python@v4
      with: python-version: 3.10
      
    - name: Install Dependencies
      run: pip install requests pandas
      
    - name: ðŸš€ Sniper Captura
      id: sniper
      run: python app-3.py
      
    - name: ðŸ§¹ Faxineiro Limpeza
      run: python limpeza.py
      
    - name: ðŸ’¾ Salvar Dados
      run: |
        git config --global user.name "Sniper Bot"
        git config --global user.email "bot@sniper.com"
        git add .
        git commit -m "Ciclo Completo $(date +%Y-%m-%d)" || echo "Sem alteraÃ§Ãµes"
        git push
        
    - name: ðŸ”„ Efeito DominÃ³
      if: steps.sniper.outputs.triggernext == 'true'
      run: gh workflow run sync-data.yml
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
